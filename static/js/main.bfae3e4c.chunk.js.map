{"version":3,"sources":["Source.js","logo.svg","App.js","reportWebVitals.js","index.js"],"names":["sources","label","method","value","nop","fetch_from","entry","a","undefined","source","find","e","type","console","log","key","params","join","fetch","resp","json","status","results","platforms","fetch_vault","plat","map","item","deposit_usd","reward_usd","total","platform","token","toLowerCase","usd","Object","entries","f","flat","isEntryEqual","e1","e2","newEntry","t","k","emptyEntry","Source","onSubmit","onDelete","defaultType","useState","setType","setKey","getEntry","buttonText","className","role","preventDefault","defaultValue","onChange","target","s","toUpperCase","size","placeholder","onClick","aria-label","aria-hidden","entriesKey","Config","newConfigCallback","setEntries","useEffect","localStorage","getItem","savedEntries","JSON","parse","stringify","setItem","updateAndSend","newEntries","submitEntry","old","idx","findIndex","push","deleteEntry","splice","length","Stats","reduce","acc","row","toFixed","App","setResults","all","arr","fn","Promise","res","fetchAndProcess","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.bfae3e4c.chunk.js","sourcesContent":["const sources = [\n  { label: \"Yieldwatch (BSC)\", method: fetch_yieldwatch },\n  { label: \"Kraken\", value:  nop },\n  { label: \"Binance\", value: nop  }\n];\n\nasync function fetch_from(entry) {\n    const source = sources.find(e => e.label == entry.type);\n    if (source == undefined) {\n        console.log(\"ERROR FETCH FROM UNDEFINED \",entry);\n        throw \"Error undefined source\";\n    }\n    return await source.method(entry.key);\n}\n\nasync function fetch_yieldwatch(key) {\n    console.log(\"YieldWatch fetching\"); \n    const platforms_url = [\"beefy\",\"pancake\",\"auto\",\"bunny\"];\n    const params = platforms_url.join(\",\");\n    const resp = await fetch(`https://www.yieldwatch.net/api/all/${key}?platforms=${params}`);\n    const json = await resp.json();\n    if (json.status == \"0\") {\n        throw \"Invalid request (maybe invalid address?\";\n    }\n    const results = json[\"result\"]; \n    const fetch_vault = (plat) => {\n        return results[plat][\"vaults\"][\"vaults\"].map(item => {\n            const deposit_usd = item[\"priceInUSDDepositToken\"];\n            const reward_usd = item[\"priceInUSDRewardToken\"];\n            const current_tokens = item[\"currentTokens\"];\n            const pending_rewards = item[\"pendingRewards\"];\n            const total = deposit_usd * current_tokens + reward_usd * pending_rewards;\n            return { \n                platform: plat, \n                token: item[\"depositToken\"].toLowerCase(), \n                usd: total \n            };\n            });\n    };\n    const fetch_stake = (plat) => {\n        return results[plat][\"staking\"][\"vaults\"].map(item => {\n            const usd_price = item[\"priceInUSDDepositToken\"]\n            const deposited = item[\"depositedTokens\"]\n            const pending = item[\"pendingRewards\"]\n            const total = usd_price * (deposited + pending)\n            return {\n                platform: plat,\n                token: item[\"depositToken\"],\n                usd: total\n            };\n        });\n    };\n    const platforms = { // TODO more\n        \"bunny\": [fetch_vault,fetch_stake],\n        \"Autofarm\": [fetch_vault]\n    }; \n    return Object.entries(platforms).map(([plat, fetches]) => {\n        return fetches.map(f => f(plat)).flat()\n    }).flat()\n}\n\nasync function nop() {\n    console.log(\"NOT IMPLEMENTED YET\");\n    return [];\n}\nexport {\n    sources,\n    fetch_from,\n}\n//exports.sources = sources;\n//exports.fetch_from = fetch_from;\n","export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import logo from './logo.svg';\nimport './App.css';\nimport React, { useState, useEffect } from 'react';\nimport Select from 'react-select';\nimport { sources, fetch_from } from './Source.js';\n\n// a source entry is { type: <type>, key: <key> }\nconst isEntryEqual = (e1,e2) => e1.type == e2.type && e1.key == e2.key;\nconst newEntry = (t,k) => { return { type: t, key: k }; };\nconst emptyEntry = newEntry(\"\",\"\");\n\nfunction Source({entry,onSubmit,onDelete}) {\n    const defaultType = () => {\n        if (entry == undefined || entry.type == \"\") {\n            console.log(\"DEFAULT VALUE EMPTY \",entry,\" => replace by \",sources[0].label);\n            return sources[0].label;\n        } else {\n            return entry.type;\n        }\n    }\n    const [type,setType] = useState(defaultType());\n    const [key,setKey] = useState(entry.key);\n\n    const getEntry = () => newEntry(type,key);\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        const newEntry = getEntry();\n        console.log(\"OLD ENTRY \",entry,\" => NEW ENTRY (type\",type,\") : \",newEntry);\n        onSubmit(entry,newEntry);\n        setType(\"\");\n        setKey(\"\");\n    };\n\n    console.log(\"NEW RENDER : type\",type, defaultType(), entry);\n    const buttonText = isEntryEqual(entry,emptyEntry) ? \"Add Source\" : \"Update\";\n    //const optionsDict = sources.map(e => {e.type: e.type.toUpperCase() });\n\n    return (\n        <div className='row'>\n            <form className= \"form-inline well\" role=\"form\" onSubmit={handleSubmit}>\n                <div className=\"form-group\">\n                    <label  className=\"col-md-1\">Source</label>\n                    <select className=\"form-control col-md-3\" \n                            value={type} \n                            defaultValue={sources[0].label}\n                            onChange={e => setType(e.target.value)}>\n                        { sources.map(s => \n                            <option value={s.label}> \n                                {s.label.toUpperCase()} \n                            </option>) }\n                    </select>\n                    <input\n                      value={key}\n                      onChange={e => setKey(e.target.value)}\n                      type='text'\n                      size=\"50\"\n                      className='form-control col-md-5 col-md-offset-4'\n                      placeholder='Enter API / Public key'\n                    />\n\n                    <button className='btn btn-primary col-md-2'>\n                        {buttonText}\n                    </button>\n                    <button type=\"button\" \n                        onClick={() => onDelete(getEntry())}    \n                        className=\"close col-md-1\" \n                        aria-label=\"Delete\">\n                      <span aria-hidden=\"true\">&times;</span>\n                    </button>\n                </div>\n            </form> \n        </div>\n    );\n}\n\nconst entriesKey = \"sources\";\n\nfunction Config({newConfigCallback}) {\n    // contains the list of entries with always an empty entry\n    const [entries,setEntries] = useState([]);\n\n    useEffect(() => {\n        // load entries only at the beginning\n        const json = localStorage.getItem(entriesKey);\n        const savedEntries = JSON.parse(json);\n        if (savedEntries) {\n            console.log(\"LOADED entries from storage \",savedEntries);\n            setEntries(savedEntries);\n        }\n    },[]);\n\n    useEffect(() => {\n        const json = JSON.stringify(entries);\n        localStorage.setItem(entriesKey,json);\n        newConfigCallback(entries); \n        console.log(\"SAVED entries to storage\", entries);\n    },[entries])\n\n    const updateAndSend = () => {\n        const newEntries = [...entries];\n        setEntries(newEntries);\n    };\n        \n    const submitEntry = (old,newEntry) => {\n        let idx = entries.findIndex(e => isEntryEqual(old,e));\n        if (idx != -1) { // entry is being updated\n            entries[idx] = newEntry;\n        } else { // entry is being created for the first time\n            entries.push(newEntry);\n            console.log(\"INSERTING new entry at \",idx,\" => \",entries);\n        }\n        updateAndSend();\n    };\n\n    const deleteEntry = (entry) => {\n        console.log(\"DELETE ENTRY \",entry,\" ON \",entries);\n        let idx = entries.findIndex(e => isEntryEqual(entry,e));\n        if (idx == -1) {\n            // silent return because the entry is the empty one\n            return; \n        }\n        entries.splice(idx,1);\n        console.log(\"DELETE ENTRY NEW STATE\",entries);\n        updateAndSend();\n    }\n    console.log(\"ENTRIES SIZE: \",entries.length, \" ==> \",entries);\n    return (\n        <div className=\"Config\"> \n        {\n            entries.map(e => \n                <Source \n                    key={JSON.stringify(e)}\n                    entry={e}\n                    onSubmit={submitEntry} \n                    onDelete={deleteEntry}\n                />\n            )\n        }\n        {\n            <Source \n                key={JSON.stringify(emptyEntry)}\n                entry={emptyEntry}\n                onSubmit={submitEntry} \n                onDelete={deleteEntry}\n            />\n        }\n        </div>\n    );\n}\n\nfunction Stats({results}) {\n    const total = results.reduce((acc,row) => acc + row.usd,0);\n    return (\n       <div>\n            You got {total.toFixed(2)} dollars in there !\n        </div>\n    );\n}\n\nfunction asyncMap(arr, fn) {\n  return Promise.all(arr.map(fn));\n}\n\nfunction App() {\n    const [results,setResults] = useState([]);\n    const newConfig = (entries) => {\n        console.log(\"NEW ENTRIES SETUP: \",entries);\n        const fetchAndProcess = async (all) => {\n            const res = (await asyncMap(entries,fetch_from)).flat();\n            console.log(\"NEW RESULTS\",res);\n            setResults(res);\n        };\n        fetchAndProcess(entries);\n    };\n\n\n  return (\n    <div className=\"row\">\n        <div className=\"col-md-8 mx-auto\">\n            <header className=\"App-header\">\n            <p>\n                Crypto Summary\n            </p>\n            </header>\n            <Config newConfigCallback={newConfig} />\n            <Stats results={results} />\n        </div>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}