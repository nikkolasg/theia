{"version":3,"sources":["Source.js","logo.svg","App.js","reportWebVitals.js","index.js"],"names":["sources","label","method","value","nop","fetch_from","entry","a","undefined","source","find","e","type","console","log","key","params","join","fetch","resp","json","status","results","platforms","fetch_vault","plat","map","item","deposit_usd","reward_usd","total","platform","token","toLowerCase","usd","Object","entries","f","flat","balance","Math","pow","get_price_usd","price","symbol","headers","accept","req","isEntryEqual","e1","e2","newEntry","t","k","emptyEntry","Source","onSubmit","onDelete","defaultType","useState","setType","setKey","getEntry","buttonText","className","role","preventDefault","defaultValue","onChange","target","s","toUpperCase","size","placeholder","onClick","aria-label","aria-hidden","entriesKey","Config","newConfigCallback","setEntries","useEffect","localStorage","getItem","savedEntries","JSON","parse","stringify","setItem","updateAndSend","newEntries","submitEntry","old","idx","findIndex","push","deleteEntry","splice","length","resultsKey","Stats","reduce","acc","row","toFixed","data","App","setResults","savedResults","all","arr","fn","Promise","res","fetchAndProcess","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.c251c805.chunk.js","sourcesContent":["const sources = [\n  { label: \"Yieldwatch (BSC)\", method: fetch_yieldwatch },\n  { label: \"Filfox (FIL)\", method: fetch_fil },\n  { label: \"Kraken\", value:  nop },\n  { label: \"Binance\", value: nop  }\n];\n\nasync function fetch_from(entry) {\n    const source = sources.find(e => e.label == entry.type);\n    if (source == undefined) {\n        console.log(\"ERROR FETCH FROM UNDEFINED \",entry);\n        throw \"Error undefined source\";\n    }\n    return await source.method(entry.key);\n}\n\nasync function fetch_yieldwatch(key) {\n    console.log(\"YieldWatch fetching\"); \n    const platforms_url = [\"beefy\",\"pancake\",\"auto\",\"bunny\"];\n    const params = platforms_url.join(\",\");\n    const resp = await fetch(`https://www.yieldwatch.net/api/all/${key}?platforms=${params}`);\n    const json = await resp.json();\n    if (json.status == \"0\") {\n        throw \"Invalid request (maybe invalid address?\";\n    }\n    const results = json[\"result\"]; \n    const fetch_vault = (plat) => {\n        return results[plat][\"vaults\"][\"vaults\"].map(item => {\n            const deposit_usd = item[\"priceInUSDDepositToken\"];\n            const reward_usd = item[\"priceInUSDRewardToken\"];\n            const current_tokens = item[\"currentTokens\"];\n            const pending_rewards = item[\"pendingRewards\"];\n            const total = deposit_usd * current_tokens + reward_usd * pending_rewards;\n            return { \n                platform: plat, \n                token: item[\"depositToken\"].toLowerCase(), \n                usd: total \n            };\n            });\n    };\n    const fetch_stake = (plat) => {\n        return results[plat][\"staking\"][\"vaults\"].map(item => {\n            const usd_price = item[\"priceInUSDDepositToken\"]\n            const deposited = item[\"depositedTokens\"]\n            const pending = item[\"pendingRewards\"]\n            const total = usd_price * (deposited + pending)\n            return {\n                platform: plat,\n                token: item[\"depositToken\"],\n                usd: total\n            };\n        });\n    };\n    const platforms = { // TODO more\n        \"bunny\": [fetch_vault,fetch_stake],\n        \"Autofarm\": [fetch_vault]\n    }; \n    return Object.entries(platforms).map(([plat, fetches]) => {\n        return fetches.map(f => f(plat)).flat()\n    }).flat()\n}\n\nasync function fetch_fil(key) {\n    const resp = await fetch(`https://filfox.info/api/v1/address/${key}`);\n    const json = await resp.json();\n    if (json[\"statusCode\"]) {\n        throw \"Invalid FIL request\";\n    }\n    const balance = json[\"balance\"] / Math.pow(10,18);\n    const price = await get_price_usd(\"filecoin\");\n    return {\n        plat: \"FIL\",\n        token: \"FIL\",\n        usd: balance * price,\n    };\n}\n\nasync function get_price_usd(symbol) {\n    const req = await fetch(`https://api.coingecko.com/api/v3/coins/${symbol}?tickers=true&community_data=false&developer_data=false&sparkline=false`, \n        { headers: { accept : \"application/json\" }});\n    const json = await req.json();\n    return json[\"market_data\"][\"current_price\"][\"usd\"];\n}\n\nasync function nop() {\n    console.log(\"NOT IMPLEMENTED YET\");\n    return [];\n}\nexport {\n    sources,\n    fetch_from,\n}\n//exports.sources = sources;\n//exports.fetch_from = fetch_from;\n","export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import logo from './logo.svg';\nimport './App.css';\nimport React, { useState, useEffect } from 'react';\nimport Select from 'react-select';\nimport { sources, fetch_from } from './Source.js';\nimport { CSVLink } from \"react-csv\";\n\n// a source entry is { type: <type>, key: <key> }\nconst isEntryEqual = (e1,e2) => e1.type == e2.type && e1.key == e2.key;\nconst newEntry = (t,k) => { return { type: t, key: k }; };\nconst emptyEntry = newEntry(\"\",\"\");\n\nfunction Source({entry,onSubmit,onDelete}) {\n    const defaultType = () => {\n        if (entry == undefined || entry.type == \"\") {\n            console.log(\"DEFAULT VALUE EMPTY \",entry,\" => replace by \",sources[0].label);\n            return sources[0].label;\n        } else {\n            return entry.type;\n        }\n    }\n    const [type,setType] = useState(defaultType());\n    const [key,setKey] = useState(entry.key);\n\n    const getEntry = () => newEntry(type,key);\n    const handleSubmit = (e) => {\n        e.preventDefault();\n        const newEntry = getEntry();\n        console.log(\"OLD ENTRY \",entry,\" => NEW ENTRY (type\",type,\") : \",newEntry);\n        onSubmit(entry,newEntry);\n        setType(\"\");\n        setKey(\"\");\n    };\n\n    console.log(\"NEW RENDER : type\",type, defaultType(), entry);\n    const buttonText = isEntryEqual(entry,emptyEntry) ? \"Add Source\" : \"Update\";\n    //const optionsDict = sources.map(e => {e.type: e.type.toUpperCase() });\n\n    return (\n        <div className='row'>\n            <form className= \"form-inline well\" role=\"form\" onSubmit={handleSubmit}>\n                <div className=\"form-group\">\n                    <label  className=\"col-md-1\">Source</label>\n                    <select className=\"form-control col-md-3\" \n                            value={type} \n                            defaultValue={sources[0].label}\n                            onChange={e => setType(e.target.value)}>\n                        { sources.map(s => \n                            <option value={s.label}> \n                                {s.label.toUpperCase()} \n                            </option>) }\n                    </select>\n                    <input\n                      value={key}\n                      onChange={e => setKey(e.target.value)}\n                      type='text'\n                      size=\"50\"\n                      className='form-control col-md-5 col-md-offset-4'\n                      placeholder='Enter API / Public key'\n                    />\n\n                    <button className='btn btn-primary col-md-2'>\n                        {buttonText}\n                    </button>\n                    <button type=\"button\" \n                        onClick={() => onDelete(getEntry())}    \n                        className=\"close col-md-1\" \n                        aria-label=\"Delete\">\n                      <span aria-hidden=\"true\">&times;</span>\n                    </button>\n                </div>\n            </form> \n        </div>\n    );\n}\n\nconst entriesKey = \"sources\";\n\nfunction Config({newConfigCallback}) {\n    // contains the list of entries with always an empty entry\n    const [entries,setEntries] = useState([]);\n\n    useEffect(() => {\n        // load entries only at the beginning\n        const json = localStorage.getItem(entriesKey);\n        const savedEntries = JSON.parse(json);\n        if (savedEntries) {\n            console.log(\"LOADED entries from storage \",savedEntries);\n            setEntries(savedEntries);\n        }\n    },[]);\n\n    useEffect(() => {\n        const json = JSON.stringify(entries);\n        localStorage.setItem(entriesKey,json);\n        newConfigCallback(entries); \n        console.log(\"SAVED entries to storage\", entries);\n    },[entries])\n\n    const updateAndSend = () => {\n        const newEntries = [...entries];\n        setEntries(newEntries);\n    };\n        \n    const submitEntry = (old,newEntry) => {\n        let idx = entries.findIndex(e => isEntryEqual(old,e));\n        if (idx != -1) { // entry is being updated\n            entries[idx] = newEntry;\n        } else { // entry is being created for the first time\n            entries.push(newEntry);\n            console.log(\"INSERTING new entry at \",idx,\" => \",entries);\n        }\n        updateAndSend();\n    };\n\n    const deleteEntry = (entry) => {\n        console.log(\"DELETE ENTRY \",entry,\" ON \",entries);\n        let idx = entries.findIndex(e => isEntryEqual(entry,e));\n        if (idx == -1) {\n            // silent return because the entry is the empty one\n            return; \n        }\n        entries.splice(idx,1);\n        console.log(\"DELETE ENTRY NEW STATE\",entries);\n        updateAndSend();\n    }\n    console.log(\"ENTRIES SIZE: \",entries.length, \" ==> \",entries);\n    return (\n        <div className=\"Config\"> \n        {\n            entries.map(e => \n                <Source \n                    key={JSON.stringify(e)}\n                    entry={e}\n                    onSubmit={submitEntry} \n                    onDelete={deleteEntry}\n                />\n            )\n        }\n        {\n            <Source \n                key={JSON.stringify(emptyEntry)}\n                entry={emptyEntry}\n                onSubmit={submitEntry} \n                onDelete={deleteEntry}\n            />\n        }\n        </div>\n    );\n}\n\nconst resultsKey = \"results\";\n\nfunction Stats({results}) {\n    const total = results.reduce((acc,row) => acc + row.usd,0);\n\n    return (\n       <div>\n            <div className=\"row\">\n                You got {total.toFixed(2)} dollars in there !\n            </div>\n            <div className=\"row\">\n                <CSVLink data={results}>Download CSV results</CSVLink>;   \n            </div>\n        </div>\n\n    );\n}\n\nfunction asyncMap(arr, fn) {\n  return Promise.all(arr.map(fn));\n}\n\nfunction App() {\n    const [results,setResults] = useState([]);\n\n    useEffect(() => {\n        const json = localStorage.getItem(resultsKey);\n        const savedResults = JSON.parse(json);\n        if (savedResults) {\n            setResults(savedResults)\n        }\n    },[]);\n\n    useEffect(() => {\n        const json = JSON.stringify(results);\n        localStorage.setItem(resultsKey,json);\n    },[results]);\n\n\n    const newConfig = (entries) => {\n        console.log(\"NEW ENTRIES SETUP: \",entries);\n        const fetchAndProcess = async (all) => {\n            const res = (await asyncMap(entries,fetch_from)).flat();\n            console.log(\"NEW RESULTS\",res);\n            setResults(res);\n        };\n        fetchAndProcess(entries);\n    };\n\n\n  return (\n    <div className=\"row\">\n        <div className=\"col-md-8 mx-auto\">\n            <header className=\"App-header\">\n            <p>\n                Crypto Summary\n            </p>\n            </header>\n            <Config newConfigCallback={newConfig} />\n            <Stats results={results} />\n        </div>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}